"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
var composerLockFileParser = require("@snyk/composer-lockfile-parser");
var system_deps_1 = require("./system-deps");
var PLUGIN_NAME = 'snyk-php-plugin';
function inspect(basePath, fileName, options) {
    if (options === void 0) { options = {}; }
    return tslib_1.__awaiter(this, void 0, void 0, function () {
        var systemVersions, depsTree;
        return tslib_1.__generator(this, function (_a) {
            systemVersions = system_deps_1.systemDeps(basePath, options);
            depsTree = composerLockFileParser.buildDepTreeFromFiles(basePath, fileName, systemVersions);
            return [2 /*return*/, Promise.resolve({
                    package: depsTree,
                    plugin: { name: PLUGIN_NAME, targetFile: fileName },
                })];
        });
    });
}
exports.inspect = inspect;
//# sourceMappingURL=index.js.map